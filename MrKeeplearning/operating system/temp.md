RPC는 주로 네트워크를 통해 연결된 다른 시스템에 상주하는 프로세스와 서로 통신하기를 원할 때 활용된다.

RPC는 네트워크에 연결되어 있는 시스템의 프로세스들 간에 [procedure calls](https://ko.wikipedia.org/wiki/%ED%95%A8%EC%88%98_(%EC%BB%B4%ED%93%A8%ED%84%B0_%EA%B3%BC%ED%95%99))을 추상화한 것으로 한 프로그램이 네트워크의 세부 사항을 이해하지 않고도 네트워크의 다른 컴퓨터에 있는 프로그램에서 서비스를 요청하는 데 사용할 수 있는 프로세스 간 통신 기술이다.

RPC는 IPC를 기반으로 구현되었기 때문에 IPC 메커니즘과 많은 면에서 유사하다. 그러나, 프로세스가 별도의 시스템에서 실행되는 환경을 다루고 있기 때문에 RPC의 원격 서비스를 제공할 때 **메시지 기반 통신 방식**을 사용해야 한다. 따라서 IPC의 통신 방식 중 Message passing system을 사용해야 한다.

RPC는 IPC의 Message passing system을 활용하게 되는데, IPC와 RPC는 무슨 차이가 있을까?

IPC와 달리 RPC 통신으로 교환되는 메시지는 잘 구성되어 있기(well structured) 때문에 더 이상 단순한 데이터 패킷이 아니다. 한편, IPC의 경우 메시지 전달 시스템으로 전달되는 메시지는 단지 데이터 패킷일 뿐이다.




IPC의 방법 중 하나였던 메시지 전달 시스템에서 주고받던 메시지들은 단순 데이터 패킷이었을 뿐 그 이상도 이하도 아니었다. 메시지 패싱 시스템에서 sender 프로세스는 커널로 메시지를 전달하고 커널에 들어간 메시지는 원래 보내져야 하는 receiver 측으로 커널에 의해 보내진다.

하지만 RPC에서 메시지는 하나의 시스템 안에서만 이동하는 것이 아니라 여러 시스템 사이를 오고가야 하는 메시지이다. 네트워크를 지나다녀야 하기 때문에 단순 패킷이어서는 안되고 well-structured된 상태여야 한다.

RPC에서 주고 받는 메시지는 원격 시스템의 포트를 수신하는 RPC 데몬(daemon)으로 보내지며 각 메시지에는 실행할 함수의 식별자와 해당 함수에 전달할 매개 변수가 포함된다.

이렇게 메시지가 전달되면 sender측의 요청대로 함수는 실행되고, 모든 출력은 별도의 메시지로 요청자에게 다시 전송된다.

### RPC는 어떻게 클라이언트가 로컬에서 프로시저를 호출하는 것처럼 원격 호스트에서 프로시저를 호출할 수 있도록 하는 것일까?

<p align="center">
<img src="https://user-images.githubusercontent.com/27791880/230564311-871b6a1f-f1c3-4cb1-8216-255c4ab6dcd9.png">
</p>

우리는 이미 로컬 환경에서 프로세스들이 어떻게 통신하는지에 대해서 앞서 살펴보았다. 그렇다면 RPC에서 네트워크로 연결된 두 개의 서로 다른 시스템에 있는 프로세스들이 어떻게 통신하는지 살펴보자.

RPC 시스템은 클라이언트 측에 stub을 제공하여 통신을 수행할 수 있는 세부 정보를 숨긴다. 그리고 일반적으로 각각의 개별 원격 프로시저에 대해서 별도의 스텁이 존재한다.

따라서, RPC를 이용할 때 프로세스는 통신이 어떻게 이루어지는지에 대해서 고려할 필요가 없다.

클라이언트가 원격 프로시저를 호출하면 RPC 시스템은 적절한 스텁을 호출하여 원격 프로시저에게 제공된 매개 변수를 전달한다. 이 스텁은 서버에서 포트를 찾고 매개 변수를 마샬링한다.

매개변수 마셜링(parameter marshalling)에는 매개 변수를 네트워크를 통해서 전송할 수 있는 형식으로 패키징하는 작업이 포함된다.

그런 다음 스텁은 메시지 전달을 사용하여 메시지를 서버로 전송한다. 서버 측의 유사한 스텁이 이 메시지를 수신하고 서버에서 프로시저를 호출한다. 필요한 경우 반환 값은 동일한 기법을 사용하여 클라이언트에게 다시 전달된다. 